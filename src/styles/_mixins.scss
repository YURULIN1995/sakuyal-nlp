@use 'sass:map';

// ==========================================================================
// 1. 總代理區 (The Facade)
// ==========================================================================
// ❌ 移除：不再對外暴露原始斷點 Map
// @forward 'breakpoints'; 

// ❌ 移除：不再對外暴露原始顏色 Map
// @forward 'colors';


// ==========================================================================
// 2. 內部引用區
// ==========================================================================
@use 'breakpoints' as bp;
@use 'colors' as c; 

// ==========================================================================
// 3. 工具函數 (Utility Functions)
// ==========================================================================

/// 取得顏色 (Color Getter)
@function get-color($cat, $shade: 'base', $opacity: 1) {
  @if not map.has-key(c.$colors, $cat) {
    @error "Color category '#{$cat}' not found in $colors map.";
  }
  $category-map: map.get(c.$colors, $cat);
  @if not map.has-key($category-map, $shade) {
     @error "Shade '#{$shade}' not found in category '#{$cat}'.";
  }
  $color-value: map.get($category-map, $shade);
  @if $opacity < 1 {
    @return rgba($color-value, $opacity);
  }
  @return $color-value;
}

/// 取得斷點 (Breakpoint Getter) - 新增這一段！
@function get-breakpoint($key) {
  // 1. 檢查斷點是否存在
  @if not map.has-key(bp.$breakpoints, $key) {
    @error "Breakpoint '#{$key}' not found in $breakpoints map. Available keys: #{map.keys(bp.$breakpoints)}";
  }
  // 2. 回傳數值
  @return map.get(bp.$breakpoints, $key);
}

// ==========================================================================
// 4. Mixins 定義
// ==========================================================================

/* --- Media Queries --- */
@mixin respond-min($key) {
  // ✅ 修改：改用 get-breakpoint() 函數
  @media (min-width: get-breakpoint($key)) {
    @content;
  }
}

@mixin respond-max($key) {
  // ✅ 修改：改用 get-breakpoint() 函數
  @media (max-width: get-breakpoint($key)) {
    @content;
  }
}

/* --- 下方保持不變 (Decorative Divider, Title, Paragraph...) --- */
// (請確保您下方關於顏色的 Mixin 依然是使用 get-color 的版本)
// ...
@mixin decorative-divider(
  $color: get-color('green', 'light'), 
  $width: 60px,
  $height: 5px,
  $top: 0,
  $left: 0,
  $is-centered: false
) {
  content: '';
  display: block;
  position: absolute;
  width: $width;
  height: $height;
  background-color: $color;
  border-radius: 3px;
  top: $top;

  @if $is-centered {
    left: 50%;
    transform: translateX(-50%);
  } @else {
    left: $left;
    transform: none;
  }
}

@mixin t-title(
  $color: get-color('green', 'dark'),
  $text-align: left,
  $text-align-md: left,
  $font-weight: 700,
  $font-size: 28px,
  $font-size-xs: 32px,
  $font-size-nav: 38px,
  $margin-bottom: 20px,
  $letter-spacing: -1px,
) {
  font-size: $font-size;
  color: $color;
  font-weight: $font-weight;
  line-height: 1.5;
  letter-spacing: $letter-spacing;
  text-align: $text-align;
  margin-bottom: $margin-bottom;

  @include respond-min(xs) {
    font-size: $font-size-xs;
  }
  @include respond-min(md) {
    text-align: $text-align-md;
  }
  @include respond-min(nav) {
    font-size: $font-size-nav;
  }
  @include respond-min(llg) {
    letter-spacing: 0.6px;
  }
}

@mixin p-paragraph (
  $margin-bottom: 25px,
  $margin-bottom-md: 25px,
  $margin-bottom-nav: 25px,
  $margin-bottom-lg: 25px,
  $line-height: 2,
  $letter-spacing: 1px,
  $font-size: 17px,
  $font-size-md: 17.6px,
  $font-size-nav: 17.6px,
  $color: get-color('green', 'base')
)
{
  font-size: $font-size;
  line-height: $line-height;
  letter-spacing: $letter-spacing;
  margin-bottom: $margin-bottom;
  color: $color;

  @include respond-min(md) {
    font-size: $font-size-md;
    margin-bottom: $margin-bottom-md;
  }
  @include respond-min(nav){
    margin-bottom: $margin-bottom-nav;
    font-size: $font-size-nav;
  }
  @include respond-min(lg) {
    margin-bottom: $margin-bottom-lg;
  }
}

@mixin b-button(
  $display: flex,
  $width: 100%,
  $bg-color: get-color('green', 'light'),
  $hover-color: get-color('green', 'dark'),
  $text-color: get-color('neutral', 'white'), 
  $margin-top: 20px,
  $margin-right: 0,
  $margin-bottom: 0,
  $margin-left: 0,
  $margin-top-md: 15px,
  $margin-top-lg: 42px,
  $font-weight: 700,
  $font-size: 15px
) {
  display: $display;
  width: $width;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  gap: 5px;
  margin-top: $margin-top;
  margin-right: $margin-right;
  margin-bottom: $margin-bottom;
  margin-left: $margin-left;
  padding: 14px 30px;
  background-color: $bg-color;
  color: $text-color;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: $font-size;
  font-weight: $font-weight;
  text-decoration: none;
  transition: background-color 0.3s ease;
  white-space: nowrap;

  &:hover {
    background-color: $hover-color;
  }

  @include respond-min(md) {
    display: inline-flex;
    width: fit-content;
    padding: 14px 30px;
    margin-top: $margin-top-md;
    margin-left: auto;
    margin-right: auto;
  }
  @include respond-min(lg) {
    margin-top: $margin-top-lg;
  }
}

@mixin svg-icon-style(
  $size: 40px,
  $color: get-color('green', 'base'),
  $stroke-width: 1.5
) {
  width: $size;
  height: $size;
  stroke: $color;
  stroke-width: $stroke-width;
}