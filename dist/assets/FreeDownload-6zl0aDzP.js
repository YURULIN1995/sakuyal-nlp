import{m as b,r as i,j as e,n as s,S as N,s as L}from"./index-B-RPJ948.js";import{T as v}from"./index-lY1mLKRw.js";import{S as y}from"./check-CYC1LJVN.js";const I="_formContainer_1q9ia_4",W="_formGroup_1q9ia_9",q="_label_1q9ia_15",C="_input_1q9ia_27",T="_submitButton_1q9ia_45",k="_statusMessage_1q9ia_91",z="_success_1q9ia_101",E="_error_1q9ia_101",w="_sending_1q9ia_101",M="_loading_1q9ia_101",r={formContainer:I,formGroup:W,label:q,input:C,submitButton:T,statusMessage:k,success:z,error:E,sending:w,loading:M};function D({onSuccessRedirectTo:o}){const p=b(),[c,d]=i.useState(""),[n,l]=i.useState("idle"),[j,u]=i.useState(""),[_,f]=i.useState(""),h=i.useRef(null);i.useEffect(()=>{if(n==="success"||n==="error"){const a=setTimeout(()=>{l("idle")},5e3);return()=>clearTimeout(a)}},[n]);const S=async a=>{var x;if(a.preventDefault(),!_){l("error"),u("請完成人機驗證。");return}l("loading"),u("");try{const m=await fetch("/api/add-subscriber",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c,token:_})}),g=await m.json();if(!m.ok)throw new Error(g.message||"發生未知錯誤");l("success"),u(g.message),o?setTimeout(()=>{p(o)},1500):d("")}catch(m){l("error"),u(m.message)}finally{(n!=="success"||!o)&&((x=h.current)==null||x.reset(),f(""))}};return e.jsxs("div",{className:r.formContainer,children:[e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:r.formGroup,children:[e.jsx("label",{htmlFor:"email",className:r.label,children:"Email"}),e.jsx("input",{type:"email",id:"email",className:r.input,value:c,onChange:a=>d(a.target.value),required:!0,placeholder:"輸入Email，馬上就會收到下載連結！"})]}),e.jsx(v,{ref:h,sitekey:"1x00000000000000000000AA",onVerify:a=>f(a)}),e.jsx("button",{type:"submit",className:r.submitButton,disabled:n==="loading"||!_,children:n==="loading"?"處理中...":s.buttonText2})]}),e.jsx("p",{className:`${r.statusMessage} ${r[n]||""}`,children:j})]})}const B="_contentWrapper_ieuz3_4",F="_textSection_ieuz3_18",G="_textInnerWrapper_ieuz3_33",A="_titleLine1_ieuz3_50",O="_titleLine2_ieuz3_80",$="_shareInfo_ieuz3_135",R="_featuresList_ieuz3_140",J="_checkIcon_ieuz3_156",P="_formSection_ieuz3_166",U="_formContentWrapper_ieuz3_181",t={contentWrapper:B,textSection:F,textInnerWrapper:G,titleLine1:A,titleLine2:O,shareInfo:$,featuresList:R,checkIcon:J,formSection:P,formContentWrapper:U};function Q(){const{title:o,description:p}=L.pages.freeDownload;return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:o,description:p}),e.jsxs("main",{className:t.contentWrapper,children:[e.jsx("div",{className:t.textSection,children:e.jsxs("div",{className:t.textInnerWrapper,children:[e.jsx("img",{src:s.imageUrl,alt:s.imageAlt}),e.jsx("h1",{className:t.titleLine1,children:s.titleLine1}),e.jsx("h2",{className:t.titleLine2,children:s.titleLine2}),e.jsx("p",{children:s.paragraph})]})}),e.jsx("div",{className:t.formSection,children:e.jsxs("div",{className:t.formContentWrapper,children:[e.jsx("p",{children:s.paragraph2}),e.jsx("p",{className:t.shareInfo,children:s.paragraph3}),e.jsx("ul",{className:t.featuresList,children:s.features.map(c=>e.jsxs("li",{children:[e.jsx(y,{className:t.checkIcon}),e.jsx("span",{children:c.featureText})]},c.id))}),e.jsx(D,{onSuccessRedirectTo:"/upsell"})]})})]})]})}export{Q as default};
